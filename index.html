<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Solicita√ß√£o de Servi√ßo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .preview-img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 10px;
    }
    .logo-icon {
      width: 80px;
      height: 80px;
      color: #2563eb; /* azul Tailwind */
    }
  </style>
</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
  <div class="container max-w-2xl">
    <div class="bg-white rounded-2xl shadow-lg p-6 space-y-6">
      <div class="flex items-center gap-4">
        <!-- üîß √çcone SVG (Martelo e Chave Cruzados) -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="logo-icon" viewBox="0 0 24 24">
          <path d="M21.707 20.293l-5.066-5.066a7.002 7.002 0 0 0-7.374-9.312l1.29 1.29a5.002 5.002 0 0 1 5.223 7.025l1.532 1.532 1.414-1.414 2.828 2.828-1.414 1.414 1.067 1.067a1 1 0 0 0 1.414-1.414zM10.586 6.586L9.172 8l1.09 1.09-7.962 7.962a1.5 1.5 0 0 0 2.122 2.122l7.962-7.962L14 10.828l1.414-1.414L10.586 6.586z"/>
        </svg>

        <div>
          <h1 class="text-2xl font-bold text-gray-800">Solicita√ß√£o de Servi√ßo</h1>
          <p class="text-gray-600 text-sm">Envie sua solicita√ß√£o com evid√™ncias diretamente pelo WhatsApp</p>
        </div>
      </div>

      <form id="serviceForm" class="space-y-4">
        <div>
          <label class="block font-medium text-gray-700 mb-1">Nome Completo</label>
          <input id="name" required class="w-full border rounded-lg p-2" placeholder="Digite seu nome completo">
        </div>

        <div>
          <label class="block font-medium text-gray-700 mb-1">Telefone</label>
          <input id="phone" required class="w-full border rounded-lg p-2" placeholder="(DDD) 9xxxx-xxxx">
        </div>

        <div>
          <label class="block font-medium text-gray-700 mb-1">Tipo de Servi√ßo</label>
          <input id="serviceType" list="services" required class="w-full border rounded-lg p-2" placeholder="Descreva o tipo de servi√ßo">
          <datalist id="services">
            <option value="Higieniza√ß√£o de Estofados"></option>
            <option value="Limpeza de Colch√µes"></option>
            <option value="Higieniza√ß√£o Automotiva"></option>
            <option value="Limpeza Residencial"></option>
          </datalist>
        </div>

        <div>
          <label class="block font-medium text-gray-700 mb-1">Descri√ß√£o Detalhada</label>
          <textarea id="description" rows="3" required class="w-full border rounded-lg p-2" placeholder="Descreva o servi√ßo desejado ou problema"></textarea>
        </div>

        <div>
          <label class="block font-medium text-gray-700 mb-1">Evid√™ncias (Fotos)</label>
          <input id="evidence" type="file" accept="image/*" multiple class="block mt-1">
          <div id="preview" class="grid grid-cols-3 gap-2 mt-2"></div>
        </div>

        <button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 rounded-full flex items-center justify-center gap-2 hover:bg-blue-700 transition">
          <i class="fa fa-paper-plane"></i> Enviar Solicita√ß√£o via WhatsApp
        </button>
      </form>
    </div>
  </div>

  <script>
    const form = document.getElementById('serviceForm');
    const evidenceInput = document.getElementById('evidence');
    const preview = document.getElementById('preview');
    let selectedFiles = [];

    // Mostra pr√©vias das imagens
    evidenceInput.addEventListener('change', e => {
      preview.innerHTML = '';
      selectedFiles = Array.from(e.target.files);
      selectedFiles.forEach(file => {
        const url = URL.createObjectURL(file);
        const img = document.createElement('img');
        img.src = url;
        img.className = 'preview-img';
        preview.appendChild(img);
      });
    });

    form.addEventListener('submit', async e => {
      e.preventDefault();

      const name = document.getElementById('name').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const serviceType = document.getElementById('serviceType').value.trim();
      const description = document.getElementById('description').value.trim();

      if (!name || !phone || !serviceType || !description) {
        alert('Preencha todos os campos obrigat√≥rios.');
        return;
      }

      const message = `
üìã *Nova Solicita√ß√£o de Servi√ßo*
üë§ *Nome:* ${name}
üì± *Telefone:* ${phone}
üõ†Ô∏è *Servi√ßo:* ${serviceType}
üìù *Descri√ß√£o:* ${description}
üì∏ *Evid√™ncias:* ${selectedFiles.length} foto(s) anexada(s)
      `.trim();

      try {
        // Se o dispositivo permite compartilhamento de arquivos
        if (navigator.canShare && navigator.canShare({ files: selectedFiles })) {
          await navigator.share({
            title: 'Solicita√ß√£o de Servi√ßo',
            text: message,
            files: selectedFiles,
          });

          alert('Solicita√ß√£o enviada com sucesso pelo WhatsApp!');
        } else {
          // Fallback: envia apenas texto
          const encoded = encodeURIComponent(message);
          const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
          const url = isMobile
            ? `whatsapp://send?text=${encoded}`
            : `https://web.whatsapp.com/send?text=${encoded}`;
          window.open(url, '_blank');
          alert('Seu dispositivo n√£o permite envio direto de fotos. Mensagem aberta no WhatsApp.');
        }

        // Limpa o formul√°rio ap√≥s envio
        form.reset();
        preview.innerHTML = '';
        selectedFiles = [];

      } catch (err) {
        console.error(err);
        alert('Erro ao enviar via WhatsApp. Tente novamente.');
      }
    });
  </script>
</body>
</html>
